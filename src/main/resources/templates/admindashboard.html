<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="/css/style.css"> <!-- Shared CSS -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Cinzel:wght@500;700&family=Lora:wght@400;500&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <style>

	.dashboard {
	  padding: 100px 20px 40px; /* âœ… adds space below fixed header */
	}
    .stats {
      display: flex;
      justify-content: space-around;
      margin-bottom: 30px;
    }
    .card {
		background: linear-gradient(135deg, #3d4180, #705540);
		    color:#ffcc70 !important;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      flex: 1;
      margin: 0 10px;
      text-align: center;
    }
	p{
		color: #ffcc70;
	}
	.card h2 {
	  margin: 10px 0;
	  color:#fff !important;
	  font-size: 24px;
	  font-weight: bold;
	  background: linear-gradient(45deg, #3498db, #00bcd4);
	  -webkit-background-clip: text;
	  -webkit-text-fill-color: transparent;
	  text-fill-color: transparent;
	}
    .modal { display: none; position: fixed; z-index: 1000; inset: 0; background: rgba(0,0,0,0.5); }
    .modal-content {
		
		
      background: #fff;
      margin: 10% auto;
      padding: 20px;
      border-radius: 10px;
      width: 400px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    .close { float: right; font-size: 28px; cursor: pointer; }
	.btnadmin{
		margin: 10px 12px;
	}
	h2{
		justify-content: center;
		
	}
	p{
		font-size: 1.2rem;
	}

	#roomStatus{
		padding: 10px;
	}
  </style>
</head>
<body>
<!-- Background slideshow -->
<div class="background">
  <img src="https://images.unsplash.com/photo-1621293954908-907159247fc8?w=1600" class="active">
  <img src="https://images.unsplash.com/photo-1646645409452-866ad2fb64e4?w=1600">
  <img src="https://images.unsplash.com/photo-1549294413-26f195200c16?w=1600">
</div>
<header >
   <nav>
     <a th:href="@{/home}"><i class="fas fa-home"></i> Home</a>
     <a th:href="@{/customer-dashboard}"><i class="fas fa-user"></i> Dashboard</a>
     <a th:href="@{/logout}"><i class="fas fa-sign-out-alt"></i> Logout</a>
   </nav>
 </header>
<div class="dashboard">
	  <h1>Admin Dashboard</h1>
  <!-- Flash Messages -->
  <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
  <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

  <!-- Quick Stats -->
  <div class="stats">
    <div class="card"><h2 th:text="${roomCount}">0</h2><p>Rooms</p></div>
    <div class="card"><h2 th:text="${customerCount}">0</h2><p>Customers</p></div>
    <div class="card"><h2 th:text="${bookingCount}">0</h2><p>Bookings</p></div>
  </div>

  <!-- Add Room -->
  <div id="addRoomModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h3>Add New Room</h3>
      <form th:action="@{/admin/rooms}" method="post">
		<input  type="number" name="roomNumber" placeholder="0000" required />
        <select name="roomType" required>
          <option value="SINGLE">Single</option>
          <option value="DOUBLE">Double</option>
          <option value="FAMILYSUITE">Family Suite</option>
          <option value="LUXURYSUITE">Luxury Suite</option>
          <option value="STANDARRDROOM">Standard Room</option>
        </select>
        <input type="number" name="roomCapacity" placeholder="Capacity" required />
        <input type="number" step="0.01" name="priceperDay" placeholder="Price per Day" required />
        <input type="text" name="description" placeholder="Description" />
		<input type="number" name="discount" placeholder="Discount" />
        <select name="status" required>
          <option value="AVAILABLE">Available</option>
          <option value="BOOKED">Booked</option>
          <option value="MAINTENANCE">Maintenance</option>
        </select>
        <button type="submit" 		class="btn btn-primary">
		  <i class="bi bi-plus-lg"></i> Add Room
		</button>
      </form>
    </div>
  </div>

  <!-- Rooms -->
  <!-- Rooms -->
<div class="section">
  <div class="section-header">
    <h2>Rooms</h2>
    <button onclick="openModal()" class="btn-primary btnadmin">Add Room</button>
  </div>
  <div class="admin-dashboard">
  <table class="table ">
    <thead class="table-dark">
      <tr>
        <th>Room Number</th><th>Type</th><th>Capacity</th><th>Price/Day</th>
        <th>Discount</th><th>Description</th><th>Status</th><th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr th:each="room : ${rooms}">
        <form th:action="@{'/admin/rooms/' + ${room.id} + '/update'}" method="post">
          <td><input type="number" name="roomNumber" th:value="${room.roomNumber}"/></td>
          <td><input type="text" name="roomType" th:value="${room.roomType}"/></td>
          <td><input type="number" name="roomCapacity" th:value="${room.roomCapacity}"/></td>
          <td><input type="number" step="0.01" name="priceperDay" th:value="${room.priceperDay}"/></td>
		  <td><input type="number" name="discount" th:value="${room.discount}"/></td>
          <td><input type="text" name="description" th:value="${room.description}"/></td>
          <td>
            <span id="roomStatus" th:classappend="'status-badge ' + 
              (room.status == 'AVAILABLE' ? 'status-available' :
              (room.status == 'BOOKED' ? 'status-booked' : 'status-maintenance'))"
              th:text="${room.status}">
            </span>
          </td>
          <td>
            <button type="submit">Update</button>
        </form>
        <form th:action="@{'/admin/rooms/' + ${room.id} + '/delete'}" method="post" style="display:inline;">
          <button class="btnadmin" type="submit" onclick="return confirm('Delete this room?')">Delete</button>
        </form>
          </td>
      </tr>
    </tbody>
  </table>
  </div>
</div>


  <!-- Customers -->
  <div class="section">
    <h2>Customers</h2>
    <table class="table ">
      <thead class="table-dark"><tr><th>ID</th><th>Name</th><th>Email</th><th>Phone</th></tr></thead>
      <tbody>
        <tr class="tableCell"  th:each="customer : ${customers}">
          <td  th:text="${customer.id}"></td>
          <td  th:text="${customer.customerName}"></td>
          <td  th:text="${customer.email}"></td>
          <td  th:text="${customer.phone}"></td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Bookings -->
  <div class="section">
    <h2>Bookings</h2>
    <table class="table">
      <thead class="table-dark"><tr>
        <th>ID</th><th>Customer</th><th>Room</th>
        <th>Check-In</th><th>Check-Out</th><th>Status</th>
      </tr></thead>
      <tbody>
        <tr class="tableCell" th:each="booking : ${bookings}">
          <td  th:text="${booking.id}"></td>
          <td th:text="${booking.customer.customerName}"></td>
          <td th:text="${booking.room.roomType}"></td>
          <td   th:text="${booking.checkInDate}"></td>
          <td   th:text="${booking.checkOutDate}"></td>
          <td>
            <span th:classappend="'status-badge ' + 
              (booking.bookingStatus == 'PENDING' ? 'status-pending' :
              (booking.bookingStatus == 'CONFIRMED' ? 'status-confirmed' :
              (booking.bookingStatus == 'CANCELLED' ? 'status-cancelled' : 'status-completed')))"
              th:text="${booking.bookingStatus}">
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
  <script>
    const images = document.querySelectorAll('.background img');
    let current = 0;
    setInterval(() => {
      images[current].classList.remove('active');
      current = (current + 1) % images.length;
      images[current].classList.add('active');
    }, 3000);
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
<script>
  function openModal(){document.getElementById("addRoomModal").style.display="block";}
  function closeModal(){document.getElementById("addRoomModal").style.display="none";}
  window.onclick=function(e){var m=document.getElementById("addRoomModal"); if(e.target==m) m.style.display="none";}
</script>
</body>
</html>
